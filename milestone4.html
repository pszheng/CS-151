<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Milestone4 (CheerpJ)</title>
  <!-- defer so the script loads before our inline code runs -->
  <script src="https://cheerpj.com/latest/loader.js" defer crossorigin="anonymous"></script>
</head>
<body>
  <button id="run">Run Milestone4</button>

  <script>
    // Wait until cheerpjInit exists (in case of slow CDN/cache)
    async function waitForCheerpJ() {
      for (let i = 0; i < 50; i++) {           // ~5s total
        if (typeof window.cheerpjInit === "function") return;
        await new Promise(r => setTimeout(r, 100));
      }
      throw new Error("CheerpJ loader failed to initialize.");
    }

    (async () => {
      try {
        await waitForCheerpJ();
        await cheerpjInit();                   // initialize runtime :contentReference[oaicite:0]{index=0}

        document.getElementById('run').addEventListener('click', async () => {
          try {
            // Use the documented /app/ prefix for files served from your site root
            // (GitHub Pages mounts your repo at /CS-151/, CheerpJ maps it to /app/) :contentReference[oaicite:1]{index=1}
            await cheerpjRunJar('/app/Milestone4.jar');  // runs Main-Class in the JAR :contentReference[oaicite:2]{index=2}
          } catch (e) {
            console.error(e);
            alert('Failed to start JAR. See Console.');
          }
        });
      } catch (e) {
        console.error(e);
        alert('CheerpJ runtime did not load. See Console/Network.');
      }
    })();
  </script>
</body>
</html>
